'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getSessions = getSessions;
exports.addProxyEnv = addProxyEnv;
exports.normalizeUrl = normalizeUrl;
function getSessions(api) {
  var proxyConfig = api.getConfig().proxy;

  if (proxyConfig.servers) {
    return api.getSessions(['proxy']);
  }

  return api.getSessions(['app']);
}

function addProxyEnv(config, env) {
  var sslConfig = config.proxy.ssl;

  env.VIRTUAL_HOST = config.proxy.domains;
  env.HTTPS_METHOD = sslConfig && sslConfig.forceSSL ? 'redirect' : 'noredirect';

  if (sslConfig && sslConfig.letsEncryptEmail) {
    env.LETSENCRYPT_HOST = config.proxy.domains;
    config.app.env.LETSENCRYPT_EMAIL = sslConfig.letsEncryptEmail;
  }

  return env;
}

function normalizeUrl(config, env) {
  var _config = config;
  var sslConfig = config.proxy.ssl;
  var isHttpUrl = new RegExp('^(http)://', 'i').test(env.ROOT_URL);

  if (sslConfig && isHttpUrl) {
    var urlArray = _config.app.env.ROOT_URL.split(':');

    urlArray[0] = urlArray[0] + 's:';
    _config.app.env.ROOT_URL = urlArray.join('');
  }

  return _config.app.env.ROOT_URL;
}
//# sourceMappingURL=utils.js.map